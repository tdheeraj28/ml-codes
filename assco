import pandas as pd 
import numpy as np
import matplotlib.pyplot as plt
import networkx as nx
from mlxtend.frequent_patterns import apriori, association_rules
from mlxtend.preprocessing import TransactionEncoder
data=pd.read_csv("Market_Basket_Optimisation.csv",header=None)
transactions = []
for i in range(data.shape[0]):
    transaction = []
    for j in range(data.shape[1]):
        if (str(data.values[i, j]) != "nan"):
            transaction.append(str(data.values[i, j]))
            
    transactions.append(transaction)
te = TransactionEncoder()
x = te.fit_transform(transactions)
x
df = pd.DataFrame(x, columns = te.columns_)
df
freq_itemset = apriori(df, min_support = 0.03, use_colnames = True)
freq_itemset
rules = association_rules(freq_itemset, metric = 'confidence', min_threshold = 0.2)
rules
 
G = nx.Graph()
for _, r in rules.iterrows():
    G.add_edge(", ".join(r['antecedents']), ", ".join(r['consequents']),
               label=f"{r['confidence']:.2f}")

pos = nx.spring_layout(G)
nx.draw(G, pos, with_labels=True, node_color='lightgreen', font_size=8)
nx.draw_networkx_edge_labels(G, pos, edge_labels={(u,v):d['label'] for u,v,d in G.edges(data=True)}, font_size=7)
plt.show()
